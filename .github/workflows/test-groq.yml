name: Test Groq API

on:
  workflow_dispatch: # Ejecutar manualmente

jobs:
  test-groq:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install groq python-dotenv
      
      - name: Test Groq API
        env:
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
        run: |
          python3 << 'EOF'
          import os
          from groq import Groq
          
          print("ðŸ§ª Probando Groq API...")
          print(f"âœ“ API Key presente: {'SÃ­' if os.getenv('GROQ_API_KEY') else 'No'}")
          
          if os.getenv('GROQ_API_KEY'):
              try:
                  client = Groq(api_key=os.getenv('GROQ_API_KEY'))
                  
                  # Test simple
                  response = client.chat.completions.create(
                      model="llama-3.3-70b-versatile",
                      messages=[{"role": "user", "content": "Di 'Hola desde GitHub Actions!'"}],
                      max_tokens=50
                  )
                  
                  print(f"âœ… Respuesta de Groq: {response.choices[0].message.content}")
                  print("ðŸŽ‰ Â¡Groq funciona perfectamente en GitHub Actions!")
              except Exception as e:
                  print(f"âŒ Error: {e}")
                  exit(1)
          else:
              print("âŒ GROQ_API_KEY no configurado")
              exit(1)
          EOF
